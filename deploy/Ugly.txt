<!DOCTYPE html>
<html>
<head>
    <title>CATS-Test Set Coverage Report-0.1</title>
    <!--  (c) 2017 CA Technologies.  All Rights Reserved. -->
    <!--  Build Date: Wed Jul 25 2018 12:51:07 GMT-0700 (PDT) -->

    <script type="text/javascript">
        var APP_BUILD_DATE = "Wed Jul 25 2018 12:51:07 GMT-0700 (PDT)";
        var ARTIFACT = "US2699";
        var BUILDER  = "rajan08";
        var CHECKSUM = 25470774465;
    </script>

    <script type="text/javascript" src="/apps/2.1/sdk.js"></script>
    <!-- our highcharts (needed so that we can add patterns)
    <script type="text/javascript" src="/apps/2.1/lib/analytics/analytics-all.js"></script>
    -->


    <script type="text/javascript">
        Rally.onReady(function() {
            Ext.define("Rally.technicalservices.InfoLink",{extend:"Rally.ui.dialog.Dialog",alias:"widget.tsinfolink",informationHtml:null,title:"Build Information",defaults:{padding:5,margin:5},closable:!0,draggable:!0,autoShow:!0,width:350,informationalConfig:null,showLog:!1,logger:null,items:[{xtype:"container",itemId:"information"},{xtype:"container",itemId:"button_box"}],initComponent:function(){Ext.id(this);this.title="<span class='icon-help'> </span>"+this.title,this.callParent(arguments)},_generateChecksum:function(a){var b,c=305419896;for(a=a.replace(/var CHECKSUM = .*;/,""),a=a.replace(/var BUILDER  = .*;/,""),a=a.replace(/\s/g,""),b=0;b<a.length;b++)c+=a.charCodeAt(b)*b;return c},_checkChecksum:function(a){var b=Ext.create("Deft.Deferred"),c=this;return Ext.Ajax.request({url:document.URL,params:{id:1},success:function(a){if(text=a.responseText,CHECKSUM){var d=c._generateChecksum(text);if(CHECKSUM!==d)return void b.resolve(!1)}b.resolve(!0)}}),b.promise},_addToContainer:function(a){var b=Ext.apply({xtype:"container",height:200,overflowY:!0},this.informationalConfig);a.add(b)},afterRender:function(){var a=Rally.getApp();if(!Ext.isEmpty(this.informationalConfig)){var b=this.down("#information");this._addToContainer(b)}this.showLog&&this.logger&&this.down("#button_box").add({xtype:"rallybutton",text:"Show Log",listeners:{scope:this,click:function(){this.logger.displayLog()}}}),a.isExternal()?this.addDocked({xtype:"container",cls:"build-info",padding:2,dock:"bottom",html:"... Running externally"}):this._checkChecksum(a).then({scope:this,success:function(a){a||this.addDocked({xtype:"container",cls:"build-info",dock:"bottom",padding:2,html:'<span class="icon-warning"> </span>Checksums do not match'})},failure:function(a){console.log("oops:",a)}}),this.callParent(arguments)},beforeRender:function(){if(this.callParent(arguments),this.informationHtml&&this.addDocked({xtype:"component",componentCls:"intro-panel",padding:2,html:this.informationHtml,dock:"bottom"}),this.addDocked({xtype:"container",cls:"build-info",padding:2,dock:"bottom",html:"This app was created by the CA AC Technical Services Team."}),APP_BUILD_DATE){var a=Ext.String.format("Built on: {0} <br/>Built by: {1}",APP_BUILD_DATE,BUILDER);ARTIFACT&&(a=a+"<br/>Source artifact: "+ARTIFACT),this.addDocked({xtype:"container",cls:"build-info",padding:2,dock:"top",html:a})}}}),Ext.define("CArABU.technicalservices.Logger",{saveForLater:!1,saveLines:100,logArray:[],constructor:function(a){Ext.apply(this,a)},setSaveForLater:function(a){this.saveForLater=a},log:function(a){var b="[ "+Ext.util.Format.date(new Date,"Y-m-d H:i:s.u")+" ]",c=[];c=Ext.Array.push(c,[b]),c=Ext.Array.push(c,Ext.Array.slice(arguments,0)),this.saveForLater&&(this.logArray||(this.logArray=[]),this.logArray.push(c.join(" ")),this.logArray.length>this.saveLines&&this.logArray.shift()),window.console&&console.log.apply(console,c)},getLogText:function(){return this.logArray&&0!==this.logArray.length?this.logArray.join("<br/>"):"-- no log --"},displayLog:function(){var a=this.getLogText();this.popup=Ext.create("Rally.ui.dialog.Dialog",{width:Ext.getBody().getWidth()-20,height:Ext.getBody().getHeight()-20,closable:!0,title:"Log",autoShow:!0,layout:"border",defaults:{layout:"fit",width:"50%",border:!1},items:[{region:"center",xtype:"container",html:a,autoScroll:!0}]})}}),Ext.define("TSUtilities",{singleton:!0,loadWsapiRecords:function(a){var b=Ext.create("Deft.Deferred"),c={model:"Defect",fetch:["ObjectID"]};return Ext.create("Rally.data.wsapi.Store",Ext.Object.merge(c,a)).load({callback:function(a,c,d){d?b.resolve(a):(console.error("Failed: ",c),b.reject("Problem loading: "+c.error.errors.join(". ")))}}),b.promise},loadAStoreWithAPromise:function(a,b){var c=Ext.create("Deft.Deferred");return Ext.create("Rally.data.wsapi.Store",{model:a,fetch:b}).load({callback:function(a,b,d){d?c.resolve(this):(console.error("Failed: ",b),c.reject("Problem loading: "+b.error.errors.join(". ")))}}),c.promise}}),Ext.define("CArABU.technicalservices.chunk.Store",{MAX_CHUNK_SIZE:50,logger:new CArABU.technicalservices.Logger,constructor:function(a){this.chunkProperty=a.chunkProperty,this.chunkValue=a.chunkValue,this.storeConfig=a.storeConfig||{},this.storeType=a.storeType||"Rally.data.wsapi.Store"},load:function(){for(var a=Ext.create("Deft.Deferred"),b=[],c=this.chunkValue,d=this.storeConfig,e=0;e<c.length;e+=this.MAX_CHUNK_SIZE){var f=Ext.Array.slice(c,e,e+this.MAX_CHUNK_SIZE);b.push(this._fetchChunk(f,d))}return Deft.Promise.all(b).then({success:function(b){var c=_.flatten(b);this.logger.log("load SUCCESS results",b,c),a.resolve(c)},failure:function(b){this.logger.log("load FAILURE",c,b),a.reject(b)},scope:this}),a},_fetchChunk:function(a,b){this.logger.log("chunk.Store._fetchChunk",a,b);var c=Ext.create("Deft.Deferred"),d=this.chunkProperty,e=_.map(a,function(a){return{property:d,value:a}});e=Rally.data.wsapi.Filter.or(e),b.filters&&(Ext.isArray(b.filters)&&(b.filters=Rally.data.wsapi.Filter.and(b.filters)),e=e.and(b.filters)),this.logger.log("chunk.Store._fetchChunk",e.toString());var f=b.fetch||!0,g=b.model||"HierarchicalRequirement";return Ext.create(this.storeType,{fetch:f,filters:e,model:g,context:{project:null}}).load({callback:function(b,d,e){if(e)c.resolve(b);else{var f="Failure loading records for objectIDs: "+a.join(", ")+":  "+d.error.errors.join(",");c.resolve(f)}}}),c}}),Ext.override(Rally.ui.gridboard.SharedViewComboBox,{_isViewPreference:function(a){return"preference"===a.self.typePath&&"View"===a.get("Type")&&a.get("AppId")==this.getContext().getAppId()}}),Ext.override(Rally.data.wsapi.TreeStore,{_decorateModels:function(){var a=this.model;_.isFunction(a.getArtifactComponentModels)&&(a=a.getArtifactComponentModels()),Ext.Array.each(a,function(a){a.addField({name:"Passing",type:"auto",defaultValue:0}),a.addField({name:"Failing",type:"auto",defaultValue:0}),a.addField({name:"NoRun",type:"auto",defaultValue:0}),a.addField({name:"Other",type:"auto",defaultValue:0})}),_.each(Ext.Array.from(a),Rally.ui.grid.data.NodeInterface.decorate,Rally.ui.grid.data.NodeInterface)}}),Ext.override(Rally.ui.grid.TreeGrid,{_mergeColumnConfigs:function(a,b){var c=_.map(a,function(a){var c=_.find(b,{dataIndex:this._getColumnName(a)});return c?this._getColumnConfigFromColumn(c):a},this);return this.config&&this.config.derivedColumnCfgs&&(c=c.concat(this.config.derivedColumnCfgs)),c},_getColumnConfigsBasedOnCurrentOrder:function(a){var b=_(this.headerCt.items.getRange()).map(function(b){return _.contains(a,b.dataIndex)?b.dataIndex:_.find(a,{xtype:b.xtype,text:b.text})}).compact().value();return b},_restoreColumnOrder:function(a){var b=this._getColumnConfigsBasedOnCurrentOrder(a),c=_.filter(a,function(a){return!_.find(b,{dataIndex:a.dataIndex})||Ext.isString(a)});return b.concat(c)},_applyStatefulColumns:function(a){this.alwaysShowDefaultColumns&&_.each(this.columnCfgs,function(b){_.any(a,{dataIndex:this._getColumnName(b)})||a.push(b)},this),this.config&&this.config.derivedColumnCfgs&&_.each(this.config.derivedColumnCfgs,function(b){var c=this._getColumnName(b),d=_.find(a,function(a){return a.dataIndex===c||a.text===c});d?_.merge(d,b):a.push(b)},this),this.columnCfgs=a},_getPersistableColumnConfig:function(a){var b=this._getColumnConfigFromColumn(a),c=this._getModelField(b.dataIndex);return c&&c.getUUID&&(b.dataIndex=c.getUUID()),b},_getColumnName:function(a){var b="";return _.isString(a)?b=a:a&&a.dataIndex?b=a.dataIndex:a&&a.text&&(b=a.text),b}}),Ext.define("CArABU.technicalservices.ResultGraphTemplate",{extend:"Ext.XTemplate",width:"90%",height:"20px",config:{calculateColorFn:function(a){return colors[a]},getContainerClass:function(a){return""},getClickableClass:function(){return""},getDimensionStyle:function(){return"width: "+this.width+"; height: "+this.height+"; line-height: "+this.height+";display: inline-block"},calculateWidth:function(a,b){var c=Ext.Array.sum(Ext.Object.getValues(a));if(c>0){var d=(a[b]||0)/c*100;return d+"%"}return 0}},constructor:function(a){var b=["<tpl>",'<div class="progress-bar-container {[this.getClickableClass()]} {[this.getContainerClass(values)]}" style="{[this.getDimensionStyle()]}">','<tpl foreach=".">','<div class="rly-progress-bar" style="text-align:center;background-color: {$}; width: {[this.calculateWidth(parent,xkey)]}; "></div>',"</tpl>","</div>","</tpl>"];return this.callParent(b)}}),Ext.define("CArABU.app.TSApp",{extend:"Rally.app.App",componentCls:"app",logger:new CArABU.technicalservices.Logger,items:[{xtype:"container",itemId:"selector_box",layout:{type:"hbox"}},{xtype:"container",itemId:"top_box",layout:{type:"vbox"},items:[{xtype:"container",itemId:"totals_f_box",layout:{type:"hbox"},margin:5},{xtype:"container",itemId:"totals_box",layout:{type:"hbox"},margin:5}]},{xtype:"container",itemId:"display_box"}],integrationHeaders:{name:"CArABU.app.TSApp"},modelNames:["TestSet"],launch:function(){var a=this;this.logger.setSaveForLater(this.getSetting("saveLog")),a._addSelector()},_addSelector:function(){var a=this;a.down("#selector_box").add([{xtype:"rallyreleasecombobox",name:"releaseCombo",itemId:"releaseCombo",stateful:!0,stateId:"releaseCombo-feature-test-case",fieldLabel:"Select Release:",multiSelect:!0,margin:"10 10 10 10",width:450,labelWidth:100,cls:"rally-checkbox-combobox",valueField:"Name",showArrows:!1,displayField:"Name",listConfig:{cls:"rally-checkbox-boundlist",itemTpl:Ext.create("Ext.XTemplate",'<div class="rally-checkbox-image"></div>',"{[this.getDisplay(values)]}</div>",{getDisplay:function(a){return a.Name}})}},{xtype:"rallybutton",name:"updateButton",itemId:"updateButton",margin:"10 10 10 10",text:"Update",listeners:{click:a.updateView,scope:a}}])},updateView:function(){var a=this;if(a.down("#releaseCombo")){var b=a.down("#releaseCombo");if(0==b.valueModels.length)return void Rally.ui.notify.Notifier.showError({message:"Please select one or more releases to display the report"});var c=[];a.setLoading(!0),a._getSelectedPIs(a.modelNames[0]).then({success:function(b){0==b.length&&a.showErrorNotification("No Data found!");var d=[];Ext.Array.each(b,function(b){c.push(b.get("ObjectID")),d.push(a._getTestCaseCollection(b))}),Deft.Promise.all(d).then({success:function(b){console.log("collections",b),b=Ext.Array.flatten(b),a.lastVerdict={},a.lb_tc_results=[],Ext.Array.each(b,function(b){a.lb_tc_results.push({ObjectID:b.TestCase.get("ObjectID"),Name:b.TestCase.get("Name"),FormattedID:b.TestCase.get("FormattedID"),Method:b.TestCase.get("Method"),_ItemHierarchy:[b.TestSet.get("ObjectID"),b.TestCase.get("ObjectID")]}),a.lastVerdict[b.TestCase.get("ObjectID")]=b.TestCase.get("LastVerdict")}),a.lb_tc_results_coverage=_.uniq(a.lb_tc_results,"ObjectID"),console.log("after construct",a.lastVerdict,a.lb_tc_results),Ext.create("Rally.data.wsapi.TreeStoreBuilder").build({models:a.modelNames,enableHierarchy:!0}).then({success:a._addGrid,scope:a})},scope:a})},scope:a}).always(function(){a.setLoading(!1)})}},_getTestCaseCollection:function(a){var b=Ext.create("Deft.Deferred");return a.getCollection("TestCases").load({fetch:["FormattedID","Name","LastVerdict","ObjectID","Method"],limit:2e3,pageSize:2e3,callback:function(c,d,e){var f=[];Ext.Array.each(c,function(b){f.push({TestSet:a,TestCase:b})}),b.resolve(f)}}),b.promise},_getSelectedPIs:function(a,b){var c=this,d={model:a,fetch:["ObjectID","FormattedID","TestCases"],limit:"Infinity"};return b&&(d.filters=b),c._loadWsapiRecords(d)},_getTCs:function(a){var b=Ext.create("Deft.Deferred"),c=this;return Ext.create("CArABU.technicalservices.chunk.Store",{storeConfig:{model:"TestCase",fetch:["ObjectID","LastVerdict","TestSet","TestSets"]},chunkProperty:"TestSets.ObjectID",chunkValue:a}).load().then({success:function(a){b.resolve(a)},failure:c.showErrorNotification,scope:c}),b.promise},_addGrid:function(a){var b=this,c=b.getContext();a.on("load",b._updateAssociatedData,b);var d=[];Ext.Array.each(b.down("#releaseCombo").value,function(a){d.push({property:"Release.Name",value:a})}),d=Rally.data.wsapi.Filter.or(d),console.log("Filter>>",d&&d.toString()),b.down("#display_box").removeAll(),b.down("#display_box").add({itemId:"pigridboard",xtype:"rallygridboard",context:c,modelNames:b.modelNames,toggleState:"grid",border:1,style:{borderColor:"lightblue",borderStyle:"solid"},plugins:b._getPlugins(),gridConfig:{store:a,enableEditing:!1,storeConfig:{filters:d},stateful:!0,stateId:c.getScopedStateId("gridboard_state"),columnCfgs:b._getColumnCfgs(),derivedColumnCfgs:b.getDerivedColumns(),shouldShowRowActionsColumn:!1,enableRanking:!1,enableBulkEdit:!1,sortableColumns:!0,viewConfig:{xtype:"rallytreeview",enableTextSelection:!1,animate:!1,loadMask:!1,listeners:{cellclick:b.showDrillDown,scope:b}}},listeners:{load:b._addTotals,viewChange:b.updateView,scope:b},height:500,width:1200}),b.setLoading(!1)},_addTotals:function(a){var b=this,c=a&&a.gridConfig.store.filters.items;b.setLoading("Loading totals..."),b._getSelectedPIs(b.modelNames[0],c).then({success:function(a){var c={value:0,records:[]},d={value:0,records:[]},e={value:0,records:[]},f={value:0,records:[]},g={value:0,records:[]},h=0,i=0,j={},k={};Ext.Array.each(a,function(a){j[a.get("FormattedID")]={grandTotal:0,totalPass:0,totalFail:0,totalNoRun:0,totalOther:0,totalAutomated:0},Ext.Array.each(b.lb_tc_results_coverage,function(i){Ext.Array.contains(i._ItemHierarchy,a.get("ObjectID"))&&(k={ObjectID:i.ObjectID,FormattedID:i.FormattedID,Name:i.Name,Method:i.Method},g.value++,g.records.push(k),j[a.get("FormattedID")]?j[a.get("FormattedID")].grandTotal++:j[a.get("FormattedID")]={grandTotal:1,totalPass:0,totalFail:0,totalNoRun:0,totalOther:0,totalAutomated:0},"Automated"==i.Method&&(h++,j[a.get("FormattedID")].totalAutomated++),"Pass"==b.lastVerdict[i.ObjectID]?(c.value++,c.records.push(k),j[a.get("FormattedID")].totalPass++):"Fail"==b.lastVerdict[i.ObjectID]?(d.value++,d.records.push(k),j[a.get("FormattedID")].totalFail++):null==b.lastVerdict[i.ObjectID]||""==b.lastVerdict[i.ObjectID]?(e.value++,e.records.push(k),j[a.get("FormattedID")].totalNoRun++):(f.value++,f.records.push(k),j[a.get("FormattedID")].totalOther++))})}),g.value>0&&(i=Ext.Number.toFixed(h/g.value*100,2)),console.log("feature_totals>>",j);var l=0,m=0,n=0,o=0;b.passingFeatureFilters=[],_.each(j,function(a,c){a.grandTotal===a.totalPass&&a.grandTotal>0&&(l++,b.passingFeatureFilters.push({property:"FormattedID",operator:"!=",value:c})),a.totalFail>0&&m++,a.grandTotal>0&&0===a.totalFail&&(a.totalNoRun>0||a.totalOther>0)&&n++,0===a.totalFail&&0===a.totalPass&&0===a.totalNoRun&&0===a.totalOther&&o++}),console.log("passingFeatureFilters>>",b.passingFeatureFilters),b.down("#totals_f_box").removeAll(),b.down("#totals_box").removeAll(),Ext.create("Ext.data.Store",{storeId:"totalStore",fields:["GrandTotal","PctAutomated","TotalPass","TotalFail","TotalNoRun","TotalOther"],data:{items:[{GrandTotal:g,PctAutomated:i,TotalPass:c,TotalFail:d,TotalNoRun:e,TotalOther:f}]},proxy:{type:"memory",reader:{type:"json",root:"items"}}}),b.down("#totals_box").add({xtype:"grid",title:"Test Case Coverage",header:{style:{background:"lightBlue",color:"white","font-weight":"bold"}},sortableColumns:!1,enableColumnHide:!1,store:Ext.data.StoreManager.lookup("totalStore"),columns:[{text:"Total",dataIndex:"GrandTotal",flex:1,renderer:function(a){return a.value>0?'<a href="#">'+a.value+"</a>":0}},{text:"% Automated",dataIndex:"PctAutomated",flex:1,renderer:function(a){return a+" %"}},{text:"Passing",dataIndex:"TotalPass",flex:1,renderer:function(a){return a.value>0?'<a href="#">'+a.value+"</a>":0}},{text:"Failing",dataIndex:"TotalFail",flex:1,renderer:function(a){return a.value>0?'<a href="#">'+a.value+"</a>":0}},{text:"No Run",dataIndex:"TotalNoRun",flex:1,renderer:function(a){return a.value>0?'<a href="#">'+a.value+"</a>":0}},{text:"Other",dataIndex:"TotalOther",flex:1,renderer:function(a){return a.value>0?'<a href="#">'+a.value+"</a>":0}}],width:600,viewConfig:{listeners:{cellclick:this.showDrillDown,scope:b}}}),Ext.create("Ext.data.Store",{storeId:"totalFeatureStore",fields:["GrandTotal","FeaturePassing","FeatureFailing","FeatureNoRun","FeatureNotCovered"],data:{items:[{GrandTotal:a.length,FeaturePassing:l,FeatureFailing:m,FeatureNoRun:n,FeatureNotCovered:o}]},proxy:{type:"memory",reader:{type:"json",root:"items"}}}),b.down("#totals_f_box").add({xtype:"grid",title:"Test Set Coverage",header:{style:{background:"lightBlue",color:"white","font-weight":"bold"}},sortableColumns:!1,enableColumnHide:!1,store:Ext.data.StoreManager.lookup("totalFeatureStore"),columns:[{text:"Total Test Sets",dataIndex:"GrandTotal",flex:1},{text:"Passing Test Sets",dataIndex:"FeaturePassing",flex:1},{text:"Failing Test Sets",dataIndex:"FeatureFailing",flex:1},{text:"Incomplete <br>Test Sets",dataIndex:"FeatureNoRun",flex:1},{text:"Not Covered <br>Test Sets",dataIndex:"FeatureNotCovered",flex:1}],width:500}),b.down("#totals_f_box").add({margin:5,xtype:"rallybutton",text:"Hide Passing <br>Test Sets",listeners:{click:function(a){b._hidePassingFeatures()}},scope:b}),b.setLoading(!1)},scope:b})},_hidePassingFeatures:function(){var a=this,b=Rally.data.wsapi.Filter.and(a.passingFeatureFilters);console.log(a.down("#pigridboard"),a.passingFeatureFilters);var c=a.down("#pigridboard"),d=c&&c.gridConfig.store.filters.items;d.push(b),c.applyCustomFilter(Ext.apply({recordMetrics:!0,types:a.modelNames,filters:_.compact(d)}))},_updateAssociatedData:function(a,b,c,d){var e=this;e.setLoading(!0),e.suspendLayouts();var f={};Ext.Array.each(c,function(a){var b={value:0,records:[]},c={value:0,records:[]},d={value:0,records:[]},g={value:0,records:[]};Ext.Array.each(e.lb_tc_results,function(h){f={ObjectID:h.ObjectID,FormattedID:h.FormattedID,Name:h.Name,Method:h.Method},Ext.Array.contains(h._ItemHierarchy,a.get("ObjectID"))&&("Pass"==e.lastVerdict[h.ObjectID]?(b.records.push(f),b.value++):"Fail"==e.lastVerdict[h.ObjectID]?(c.records.push(f),c.value++):null==e.lastVerdict[h.ObjectID]||""==e.lastVerdict[h.ObjectID]?(d.records.push(f),d.value++):(g.records.push(f),g.value++))}),"testset"==a.get("_type")?(a.set("Passing",b),a.set("Failing",c),a.set("NoRun",d),a.set("Other",g)):"testcase"==a.get("_type")&&(a.set("Passing",b.value>0?{value:"Yes",records:[]}:{value:"No",records:[]}),a.set("Failing",c.value>0?{value:"Yes",records:[]}:{value:"No",records:[]}),a.set("NoRun",d.value>0?{value:"Yes",records:[]}:{value:"No",records:[]}),a.set("Other",g.value>0?{value:"Yes",records:[]}:{value:"No",records:[]}))}),e.resumeLayouts(),e.setLoading(!1)},_getPlugins:function(){var a=this,b=["TestSet","TestCase"],c=[{ptype:"rallygridboardinlinefiltercontrol",inlineFilterButtonConfig:{stateful:!0,stateId:a.getContext().getScopedStateId("filters"),modelNames:b,inlineFilterPanelConfig:{collapsed:!1,quickFilterPanelConfig:{defaultFields:["ArtifactSearch","Owner"],addQuickFilterConfig:{whiteListFields:["Milestones","Tags"]}},advancedFilterPanelConfig:{advancedFilterRowsConfig:{propertyFieldConfig:{whiteListFields:["Milestones","Tags"]}}}}}}];return c.push({ptype:"rallygridboardfieldpicker",headerPosition:"left",modelNames:b,stateful:!0,gridAlwaysSelectedValues:["Name"],stateId:a.getContext().getScopedStateId("field-picker")}),c.push({ptype:"rallygridboardsharedviewcontrol",stateful:!0,stateId:a.getContext().getScopedStateId("feature-view"),stateEvents:["select","beforedestroy"],margin:5}),c},_getColumnCfgs:function(){var a=this;return[{dataIndex:"Name",text:"Name",flex:1}].concat(a.getDerivedColumns())},getDerivedColumns:function(){var a=this;return[{tpl:'<div style="text-align:center;"></div>',text:"Result Graph",xtype:"templatecolumn",renderer:function(a,b,c){var d={lightgreen:c.get("Passing").value,red:c.get("Failing").value,yellow:c.get("NoRun").value,blue:c.get("Other").value};if(d&&Ext.isObject(d)){var e=Ext.create("CArABU.technicalservices.ResultGraphTemplate");return e.apply(d)}return""}},{tpl:'<div style="text-align:center;">{Passing}</div>',text:"Passing",xtype:"templatecolumn",renderer:function(b,c,d){return a.renderLink(d,"Passing")}},{tpl:'<div style="text-align:center;">{Failing}</div>',text:"Failing",xtype:"templatecolumn",renderer:function(b,c,d){return a.renderLink(d,"Failing")}},{tpl:'<div style="text-align:center;">{NoRun}</div>',text:"NoRun",xtype:"templatecolumn",renderer:function(b,c,d){return a.renderLink(d,"NoRun")}},{tpl:'<div style="text-align:center;">{Other}</div>',text:"Other",xtype:"templatecolumn",renderer:function(b,c,d){return a.renderLink(d,"Other")}}]},renderLink:function(a,b){var c=void 0==a.get(b).value?"--":a.get(b).value;return c>0?'<div style="text-align:center;"><a href="#">'+c+"</a></div>":'<div style="text-align:center;">'+c+"</a></div>"},showDrillDown:function(a,b,c,d){var e=a.panel.headerCt.getHeaderAtIndex(c).dataIndex||a.panel.headerCt.getHeaderAtIndex(c).text,f=["Passing","Failing","NoRun","Other","Total","GrandTotal","TotalPass","TotalFail","TotalOther","TotalNoRun"];if(Ext.Array.contains(f,e)){var g=d.get(e).records,h=Ext.create("Rally.data.custom.Store",{data:g,pageSize:2e3}),i="Records for "+e||"";Ext.create("Rally.ui.dialog.Dialog",{itemId:"detailPopup",title:i,width:.4*Ext.getBody().getWidth(),height:.4*Ext.getBody().getHeight(),closable:!0,layout:"border",items:[{xtype:"rallygrid",itemId:"popupGrid",region:"center",layout:"fit",sortableColumns:!0,showRowActionsColumn:!1,showPagingToolbar:!1,columnCfgs:this.getDrillDownColumns(i),store:h}]}).show()}},getDrillDownColumns:function(a){return[{dataIndex:"FormattedID",text:"id",renderer:function(a,b,c){var d=window.location.protocol+"//"+window.location.host+"/#/detail/testcase/"+c.get("ObjectID");return'<a href="'+d+'" target="_top" >'+c.get("FormattedID")+"</a>"}},{dataIndex:"Name",text:"Name",flex:1},{dataIndex:"Method",text:"Method",flex:1}]},_loadWsapiRecords:function(a){console.log("_loadWsapiRecords",a);var b=Ext.create("Deft.Deferred"),c=this,d={model:"Defect",fetch:["ObjectID"]};return Ext.create("Rally.data.wsapi.Store",Ext.Object.merge(d,a)).load({callback:function(a,d,e){e?b.resolve(a):(c.logger.log("Failed: ",d),b.reject("Problem loading: "+d.error.errors.join(". ")))}}),b.promise},getSettingsFields:function(){var a="5 0 5 0";return[{name:"saveLog",xtype:"rallycheckboxfield",boxLabelAlign:"after",fieldLabel:"",margin:a,boxLabel:'Save Logging<br/><span style="color:#999999;"><i>Save last 100 lines of log for debugging.</i></span>'}]},getOptions:function(){var a=[{text:"About...",handler:this._launchInfo,scope:this}];return a},_launchInfo:function(){this.about_dialog&&this.about_dialog.destroy(),this.about_dialog=Ext.create("Rally.technicalservices.InfoLink",{showLog:this.getSetting("saveLog"),logger:this.logger})},isExternal:function(){return"undefined"==typeof this.getAppId()},showErrorNotification:function(a){this.logger.log("showErrorNotification",a),Rally.ui.notify.Notifier.showError({message:a})}});

               Rally.launchApp('CArABU.app.TSApp', {
                   name: 'Test Set Coverage Report'
               });
        });
    </script>

    <style type="text/css">

.app {
}
.tsinfolink {
    position:absolute;
    right:0px;
    width: 14px;
    height: 14px;
    border-radius: 7px;
    text-align: center;
    color: white;
    background: #C0C0C0;
    border-style: solid;
    border-width: 1px;
    margin-top: 25px;
    margin-right: 5px;
    cursor: pointer;
}
    </style>

</head>
<body></body>
</html>